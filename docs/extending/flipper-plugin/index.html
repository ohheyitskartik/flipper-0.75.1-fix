<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="search" type="application/opensearchdescription+xml" title="Flipper" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="/js/code-blocks-buttons.js"></script>
<script src="/js/google-analytics.js"></script><title data-react-helmet="true">Desktop Plugin API | Flipper</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Desktop Plugin API | Flipper"><meta data-react-helmet="true" name="description" content="PluginClient"><meta data-react-helmet="true" property="og:description" content="PluginClient"><meta data-react-helmet="true" property="og:url" content="https://fbflipper.com//docs/extending/flipper-plugin"><link data-react-helmet="true" rel="shortcut icon" href="/img/icon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://fbflipper.com//docs/extending/flipper-plugin"><link rel="stylesheet" href="/styles.ede05923.css">
<link rel="preload" href="/styles.0cfb5519.js" as="script">
<link rel="preload" href="/runtime~main.07d19881.js" as="script">
<link rel="preload" href="/main.cfff2d1e.js" as="script">
<link rel="preload" href="/1.f499c85c.js" as="script">
<link rel="preload" href="/70.13b53424.js" as="script">
<link rel="preload" href="/73.def975d9.js" as="script">
<link rel="preload" href="/935f2afb.a1e65e9e.js" as="script">
<link rel="preload" href="/69.7041db55.js" as="script">
<link rel="preload" href="/1dfa6ca3.3aab30cb.js" as="script">
</head>
<body>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/icon.png" alt="Flipper Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Flipper Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Flipper</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/features/index">Features</a><a class="navbar__item navbar__link" href="/docs/getting-started/index">Setup</a><a class="navbar__item navbar__link" href="/docs/tutorial/intro">Creating Plugins</a><a href="https://github.com/facebook/flipper" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a class="navbar__item navbar__link" href="/docs/internals/index">Under the Hood</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/icon.png" alt="Flipper Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Flipper Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Flipper</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features/index">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started/index">Setup</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/intro">Creating Plugins</a></li><li class="menu__list-item"><a href="https://github.com/facebook/flipper" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internals/index">Under the Hood</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/ios">Building an iOS Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/android">Building an Android Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/react-native">Building a React Native Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/js-setup">Building a Desktop Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/js-table">Showing a table</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/js-custom">Custom Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorial/js-publishing">Publishing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Development workflow</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/dev-setup">Development Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/loading-custom-plugins">Dynamically Loading Plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/desktop-plugin-structure">Plugin structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/plugin-distribution">Plugin Distribution</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Desktop plugin APIs</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/extending/flipper-plugin">Desktop Plugin API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/extending/styling-components">Styling Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/extending/create-table-plugin">Create Table Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/extending/search-and-filter">Searching and Filtering</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Deprecated APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/ui-components">UI Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/js-plugin-api">Desktop Plugin API</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Client plugin APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/create-plugin">Client Plugin API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/error-handling">Error Handling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/arch">Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/client-plugin-lifecycle">Client Plugin Lifecycle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/extending/layout-inspector">Extending Layout Inspector</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Desktop Plugin API</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pluginclient"></a>PluginClient<a aria-hidden="true" class="hash-link" href="#pluginclient" title="Direct link to heading">#</a></h2><p><code>PluginClient</code> is the type of the <code>client</code> passed into a standard Sandy plugin.
It takes two generic arguments <code>Event</code> and <code>Methods</code>.</p><ul><li>The <code>Event</code> generic is a mapping of an event name to the data structure of the payload, as explained <a href="/docs/tutorial/js-custom#the-plugin-declaration">here</a>.</li><li>The <code>Methods</code> generic is used to describe the methods that are offered by the plugin implementation on the device. <code>Methods</code> is a mapping of a method name to a function that describes the signature of a method. The first argument of that function describes the parameters that can be passed to the client. The return type of the function should describe what is returned from the client. Wrapped with a <code>Promise</code>.</li></ul><p>Quick example on how those generics should be used:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token maybe-class-name">LogEntry</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Events that can be send by the client implementation:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token maybe-class-name">Events</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  addLogEntry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token maybe-class-name">LogEntry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  flushLogs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Methods we can invoken on the client:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token maybe-class-name">Methods</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">retrieveLogsSince</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> since</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Promise</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">client</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token parameter"> PluginClient</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token parameter">Events</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> Methods</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// etc</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The <code>PluginClient</code> received by the <code>plugin</code> exposes the following members:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="properties"></a>Properties<a aria-hidden="true" class="hash-link" href="#properties" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="device"></a><code>device</code><a aria-hidden="true" class="hash-link" href="#device" title="Direct link to heading">#</a></h4><p>Returns the <a href="#device"><code>Device</code></a> this plugin is connected to.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="appname"></a><code>appName</code><a aria-hidden="true" class="hash-link" href="#appname" title="Direct link to heading">#</a></h4><p>The name of the application, for example &#x27;Facebook&#x27;, &#x27;Instagram&#x27; or &#x27;Slack&#x27;.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="appid"></a><code>appId</code><a aria-hidden="true" class="hash-link" href="#appid" title="Direct link to heading">#</a></h4><p>A string that uniquely identifies the current application, is based on a combination of the application name and device serial on which the application is running.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="isconnected"></a><code>isConnected</code><a aria-hidden="true" class="hash-link" href="#isconnected" title="Direct link to heading">#</a></h4><p>Returns whether there is currently an active connection. This is true if:</p><ol><li>The device is still connected</li><li>The client is still connected</li><li>The plugin is currently selected by the user <em>or</em> the plugin is running in the background.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="events-listeners"></a>Events listeners<a aria-hidden="true" class="hash-link" href="#events-listeners" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onmessage"></a><code>onMessage</code><a aria-hidden="true" class="hash-link" href="#onmessage" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onMessage(event: string, callback: (params) =&gt; void)</code></p><p>This subscribes the plugin to a specific event that is fired from the client plugin (using <a href="/docs/extending/create-plugin#push-data-to-the-desktop"><code>connection.send</code></a>).
Typically used to update some of the <a href="#createstate">state</a>.
For background plugins that are currently not active in the UI, messages won&#x27;t arrive immediately, but are queued until the user opens the plugin.</p><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token maybe-class-name">Events</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  newRow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    title</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">client</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token parameter"> PluginClient</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token parameter">Events</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> rows </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> createState</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">Record</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Row</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">persist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rows&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">onMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;newRow&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">row </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* type will be inferred correctly */</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">update</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">draft</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      draft</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// etc</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onunhandledmessage"></a><code>onUnhandledMessage</code><a aria-hidden="true" class="hash-link" href="#onunhandledmessage" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onUnhandledMessage(callback: (event: string, params) =&gt; void)</code></p><p>This method subscribe to all messages arriving from the devices which is not handled by an <code>onMessage</code> handler.
This handler is untyped, and onMessage should be favored over using onUnhandledMessage if the event name is known upfront.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onactivate"></a><code>onActivate</code><a aria-hidden="true" class="hash-link" href="#onactivate" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onActivate(callback: () =&gt; void)</code></p><p>Called when the plugin is selected by the user and mounted into the Flipper Desktop UI. See also the closely related <code>onConnect</code> event.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondeactivate"></a><code>onDeactivate</code><a aria-hidden="true" class="hash-link" href="#ondeactivate" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onDeactivate(callback: () =&gt; void)</code></p><p>Triggered when the plugin is unmounted from the Flipper Desktop UI, because the user navigates to some other plugin.
In the case the plugin is destroyed while being active, onDeactivate will still be called.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onconnect"></a><code>onConnect</code><a aria-hidden="true" class="hash-link" href="#onconnect" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onConnect(callback: () =&gt; void)</code></p><p>Triggered once the connection with the plugin on the client is established, and for example <a href="#send"><code>send</code></a> can be called safely.
Typically, this happens when the plugin is activated (opened) in the Flipper Desktop.
However, for <a href="/docs/extending/create-plugin#background-plugins">background plugins</a>, this happens immediately after the plugin has been instantiated.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondisconnect"></a><code>onDisconnect</code><a aria-hidden="true" class="hash-link" href="#ondisconnect" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onDisconnect(callback: () =&gt; void)</code></p><p>Triggered once the connection with the plugin on the client has been lost.
Typically, this happens when the user leaves the plugin in the Flipper Desktop, when the plugin is disabled, or when the app or device has disconnected.
However, for <a href="/docs/extending/create-plugin#background-plugins">background plugins</a>, this event won&#x27;t fire when the user merely navigates somewhere else.
In that case, <a href="#ondeactivate"><code>onDeactivate</code></a> can be used instead.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondestroy"></a><code>onDestroy</code><a aria-hidden="true" class="hash-link" href="#ondestroy" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onDestroy(callback: () =&gt; void)</code></p><p>Called when the plugin is unloaded. This happens if the device or client has been disconnected, or when the user disables the plugin.
Note that there is no corresponding <code>onCreate</code> event, since the function body of the plugin definition acts already as &#x27;what needs to be done when the plugin is loaded/enabled&#x27;.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondeeplink"></a><code>onDeepLink</code><a aria-hidden="true" class="hash-link" href="#ondeeplink" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onDeepLink(callback: (payload: unknown) =&gt; void)</code></p><p>Trigger when the users navigates to this plugin using a deeplink, either from an external <code>flipper://</code> plugin URL, or because the user was linked here from another plugin.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onexport"></a><code>onExport</code><a aria-hidden="true" class="hash-link" href="#onexport" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onExport(callback: (idler, onStatusMessage) =&gt; Promise&lt;state&gt;)</code></p><p>Overrides the default serialization behavior of this plugin. Should return a promise with persistable state that is to be stored.
This process is async, so it is possible to first fetch some additional state from the device. </p><p>Serializable is defined as: non-cyclic data, consisting purely of primitive values, plain objects, arrays or Date, Set or Map objects.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onimport"></a><code>onImport</code><a aria-hidden="true" class="hash-link" href="#onimport" title="Direct link to heading">#</a></h4><p>Usage: <code>client.onImport(callback: (snapshot) =&gt; void)</code></p><p>Overrides the default de-serialization behavior of this plugin. Use it to update the state based on the snapshot data.
This hook will be called immediately after constructing the plugin instance.</p><p>To synchonize the types of the data between <code>onImport</code> and <code>onExport</code>, it is possible to provide a type as generic to both hooks.
The next example stores <code>counter</code> under the <code>count</code> field, and stores it as string rather than as number.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token maybe-class-name">SerializedState</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">client</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token parameter"> PluginClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> counter </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">onExport</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">SerializedState</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> counter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">onImport</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">SerializedState</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    counter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">parseInt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="methods"></a>Methods<a aria-hidden="true" class="hash-link" href="#methods" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="send"></a><code>send</code><a aria-hidden="true" class="hash-link" href="#send" title="Direct link to heading">#</a></h4><p>Usage: <code>client.send(method: string, params: object): Promise&lt;object&gt;</code></p><p>If the plugin is connected, <code>send</code> can be used to invoke a <a href="/docs/extending/create-plugin#%5Bbackground-plugins#using-flipperconnection">method</a> on the client implementation of the plugin.</p><p>Note that if <code>client.isConnected</code> returns <code>false</code>, calling <code>client.send</code> will throw an exception. This is the case if for example the connection with the device or application was lost.
Generally one should guard <code>client.send</code> calls with a check to <code>client.isConnected</code>.</p><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> </span><span class="token maybe-class-name">Methods</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">currentLogs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">since</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Promise</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">client</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token parameter"> PluginClient</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> Methods</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> logs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> createState</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">onConnect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> currentLogs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;currentLogs&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        since</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">now</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      logs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">currentLogs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Failed to retrieve current logs: &quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//etc</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="addmenuentry"></a><code>addMenuEntry</code><a aria-hidden="true" class="hash-link" href="#addmenuentry" title="Direct link to heading">#</a></h4><p>Usage: <code>client.addMenuEntry(...entry: MenuEntry[])</code></p><p>This method can be used to add menu entries to the Flipper main menu while this plugin is active.
It supports registering global keyboard shortcuts as well.
Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addMenuEntry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    label</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Reset Selection&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    topLevelMenu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Edit&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    accelerator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CmdOrCtrl+R&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">handler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Event handling</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The <code>accelerator</code> argument is optional, but describes the keyboard shortcut. See the <a href="https://www.electronjs.org/docs/api/accelerator" target="_blank" rel="noopener noreferrer">Electron docs</a> for their format. The <code>topLevelMenu</code> must be one of <code>&quot;Edit&quot;</code>, <code>&quot;View&quot;</code>, <code>&quot;Window&quot;</code> or <code>&quot;Help&quot;</code>.</p><p>It is possible to leave out the <code>label</code>, <code>topLevelMenu</code> and <code>accelerator</code> fields if a pre-defined <code>action</code> is set, which configures all three of them.
The currently pre-defined actions are <code>&quot;Clear&quot;</code>, <code>&quot;Go To Bottom&quot;</code> and <code>&quot;Create Paste&quot;</code>.
Example of using a pre-defined action:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addMenuEntry</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;createPaste&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">handler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Event handling</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ispluginavailable"></a><code>isPluginAvailable</code><a aria-hidden="true" class="hash-link" href="#ispluginavailable" title="Direct link to heading">#</a></h4><p>Usage: <code>isPluginAvailable(pluginId: string): boolean</code></p><p>Returns <code>true</code> if a plugin with the given id is available by for consumption, that is: supported by the current application / device, and enabled by the user.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="selectplugin"></a><code>selectPlugin</code><a aria-hidden="true" class="hash-link" href="#selectplugin" title="Direct link to heading">#</a></h4><p>Usage: <code>selectPlugin(pluginId: string, deeplinkPayload?: unknown): void</code></p><p>Opens a different plugin by id, optionally providing a deeplink to bring the target plugin to a certain state.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="supportsmethod"></a><code>supportsMethod</code><a aria-hidden="true" class="hash-link" href="#supportsmethod" title="Direct link to heading">#</a></h4><p>Usage: <code>client.supportsMethod(method: string): Promise&lt;Boolean&gt;</code></p><p>Resolves to true if the client supports the specified method. Useful when adding functionality to existing plugins, when connectivity to older clients is still required. Also useful when client plugins are implemented on multitple platforms and don&#x27;t all have feature parity.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="createpaste"></a><code>createPaste</code><a aria-hidden="true" class="hash-link" href="#createpaste" title="Direct link to heading">#</a></h4><p>Facebook only API.</p><p>Usage: <code>client.createPaste(value: string): Promise&lt;string|undefined&gt;</code></p><p>Creates a Facebook Paste (similar to a GitHub Gist) for the given <code>value</code>.
The returned promise either contains a string with the URL of the paste, or <code>undefined</code> if the process failed.
Details of the failure will be communicated back directly to the user through Flipper notifications.
For example if the user is currently not signed in.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="gk"></a><code>GK</code><a aria-hidden="true" class="hash-link" href="#gk" title="Direct link to heading">#</a></h4><p>Facebook only API.</p><p>Usage: <code>client.GK(gatekeeper: string): boolean</code></p><p>Returns <code>true</code> if the current user is part of the given GK. <code>false</code> in all other cases.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="devicepluginclient"></a>DevicePluginClient<a aria-hidden="true" class="hash-link" href="#devicepluginclient" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="properties-1"></a>Properties<a aria-hidden="true" class="hash-link" href="#properties-1" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="device-1"></a><code>device</code><a aria-hidden="true" class="hash-link" href="#device-1" title="Direct link to heading">#</a></h4><p>Returns the <a href="#device"><code>Device</code></a> this plugin is connected to.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="events"></a>Events<a aria-hidden="true" class="hash-link" href="#events" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondestroy-1"></a><code>onDestroy</code><a aria-hidden="true" class="hash-link" href="#ondestroy-1" title="Direct link to heading">#</a></h4><p>See the similarly named event under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onactivate-1"></a><code>onActivate</code><a aria-hidden="true" class="hash-link" href="#onactivate-1" title="Direct link to heading">#</a></h4><p>See the similarly named event under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondeactivate-1"></a><code>onDeactivate</code><a aria-hidden="true" class="hash-link" href="#ondeactivate-1" title="Direct link to heading">#</a></h4><p>See the similarly named event under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ondeeplink-1"></a><code>onDeepLink</code><a aria-hidden="true" class="hash-link" href="#ondeeplink-1" title="Direct link to heading">#</a></h4><p>See the similarly named event under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onexport-1"></a><code>onExport</code><a aria-hidden="true" class="hash-link" href="#onexport-1" title="Direct link to heading">#</a></h4><p>See the similarly named event under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onimport-1"></a><code>onImport</code><a aria-hidden="true" class="hash-link" href="#onimport-1" title="Direct link to heading">#</a></h4><p>See the similarly named event under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="methods-1"></a>Methods<a aria-hidden="true" class="hash-link" href="#methods-1" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="addmenuentry-1"></a><code>addMenuEntry</code><a aria-hidden="true" class="hash-link" href="#addmenuentry-1" title="Direct link to heading">#</a></h4><p>See the similarly named method under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="createpaste-1"></a><code>createPaste</code><a aria-hidden="true" class="hash-link" href="#createpaste-1" title="Direct link to heading">#</a></h4><p>See the similarly named method under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ispluginavailable-1"></a><code>isPluginAvailable</code><a aria-hidden="true" class="hash-link" href="#ispluginavailable-1" title="Direct link to heading">#</a></h3><p>See the similarly named method under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="selectplugin-1"></a><code>selectPlugin</code><a aria-hidden="true" class="hash-link" href="#selectplugin-1" title="Direct link to heading">#</a></h3><p>See the similarly named method under <a href="#pluginclient"><code>PluginClient</code></a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="device-2"></a>Device<a aria-hidden="true" class="hash-link" href="#device-2" title="Direct link to heading">#</a></h2><p><code>Device</code> captures the metadata of the device the plugin is currently connected to.
Device objects are passed into the <a href="/docs/tutorial/js-custom#creating-a-device-plugin"><code>supportsDevice</code> method</a> of a device plugin, and available as <code>device</code> field on a <a href="#devicepluginclient"><code>DevicePluginClient</code></a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="properties-2"></a>Properties<a aria-hidden="true" class="hash-link" href="#properties-2" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="os"></a>os<a aria-hidden="true" class="hash-link" href="#os" title="Direct link to heading">#</a></h4><p>A <code>string</code> that describes the Operating System of the device. Typical values:
<code>&#x27;iOS&#x27;</code> | <code>&#x27;Android&#x27;</code> | <code>&#x27;Windows&#x27;</code> | <code>&#x27;MacOS&#x27;</code> | <code>&#x27;Metro&#x27;</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="devicetype"></a>deviceType<a aria-hidden="true" class="hash-link" href="#devicetype" title="Direct link to heading">#</a></h4><p>A <code>string</code> that describes whether the device is a physical device or an emulator. Possible values: <code>&#x27;emulator&#x27;</code> and <code>&#x27;physical&#x27;</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="isarchived"></a>isArchived<a aria-hidden="true" class="hash-link" href="#isarchived" title="Direct link to heading">#</a></h4><p>This <code>boolean</code> flag is <code>true</code> if the current device is coming from an import Flipper snapshot, and not an actually connected device.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="isconnected-1"></a>isConnected<a aria-hidden="true" class="hash-link" href="#isconnected-1" title="Direct link to heading">#</a></h4><p>This <code>boolean</code> flag is <code>true</code> if the connection to the device is still alive.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="events-1"></a>Events<a aria-hidden="true" class="hash-link" href="#events-1" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="onlogentry"></a><code>onLogEntry</code><a aria-hidden="true" class="hash-link" href="#onlogentry" title="Direct link to heading">#</a></h4><p>Usage: <code>device.onLogEntry(callback: (logEntry: DeviceLogEntry) =&gt; void)</code></p><p>Use this event to subscribe to the log stream that is emitted by the device.
For Android this is using <code>adb</code> behind the scenes, for iOS <code>idb</code>, for Metro it connects to the webserver for the Metro log output, etc.</p><p>The <code>DeviceLogEntry</code> exposes the following fields:</p><ul><li><code>date: Date</code></li><li><code>type: string</code></li><li><code>message: string</code></li><li><code>pid: number</code></li><li><code>tid: number</code></li><li><code>app?: string</code></li><li><code>tag: string</code></li></ul><p>For <code>type</code>, the possible values are <code>&#x27;unknown&#x27;</code>, <code>&#x27;verbose&#x27;</code>, <code>&#x27;debug&#x27;</code>, <code>&#x27;info&#x27;</code>, <code>&#x27;warn&#x27;</code>, <code>&#x27;error&#x27;</code> and <code>&#x27;fatal&#x27;</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="state-management"></a>State Management<a aria-hidden="true" class="hash-link" href="#state-management" title="Direct link to heading">#</a></h2><p>State in Sandy plugins is stored in small containers that hold immutable values, and can be consumed in React components using the <a href="#usevalue"><code>useValue</code></a> hook.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="createstate"></a>createState<a aria-hidden="true" class="hash-link" href="#createstate" title="Direct link to heading">#</a></h3><p>Usage: <code>createState&lt;T&gt;(initialValue: T, options?): StateAtom&lt;T&gt;</code></p><p>The <code>createState</code> method can be used to create a small state container that lives inside a Sandy plugin.
Its value should be treated as immutable and is initialized by default using the <code>initialValue</code> parameter.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="options"></a>Options<a aria-hidden="true" class="hash-link" href="#options" title="Direct link to heading">#</a></h4><p>Optionally, <code>options</code> can be provided when creating state. Supported options:</p><ul><li><code>persist: string</code>. If the <code>persist</code> value is set, this state container will be serialized when n Flipper snapshot export is being made. When a snapshot is imported into Flipper, and plugins are initialized, this state container will load its initial value from the snapshot, rather than using the <code>initialValue</code> parameter. The <code>persist</code> key should be unique within the plugin and only be set if the state stored in this container is serializable and won&#x27;t become unreasonably large. See also <code>exportState</code> and <code>initialState</code> in the <a href="#testutils"><code>TestUtils</code></a> section.</li></ul><p>Serializable is defined as: non-cyclic data, consisting purely of primitive values, plain objects, arrays or Date, Set or Map objects.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-state-atom-object"></a>The state atom object<a aria-hidden="true" class="hash-link" href="#the-state-atom-object" title="Direct link to heading">#</a></h4><p>A state atom object is returned by <code>createState</code>, exposing the following methods:</p><ul><li><code>get(): T</code>: Returns the current value stored. If you want to use the atom object in a React component, consider using the <code>useValue</code> hook instead, to make sure the component is notified about future updates of this atom.</li><li><code>set(newValue: T)</code>: Stores a new value into the atom. If the new value is not reference-equal to the previous one, all observing components will be notified.</li><li><code>update(updater: (draft: Draft&lt;T&gt;) =&gt; void)</code>: Updates the current state using an <a href="https://immerjs.github.io/immer/docs/introduction" target="_blank" rel="noopener noreferrer">Immer</a> recipe. In the <code>updater</code>, the <code>draft</code> object can be safely (deeply) mutated. Once the <code>updater</code> finishes, Immer will compute a new immutable object based on the changes, and store that. This is often simpler than using a combination of <code>get</code> and <code>set</code> if deep updates need to be made to the stored object.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="example"></a>Example<a aria-hidden="true" class="hash-link" href="#example" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">createState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;flipper-plugin&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> rows </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> createState</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">persist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rows&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> selectedID </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> createState</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">null</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">persist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;selection&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;hello&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">update</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">draft</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  draft</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="react-hooks"></a>React Hooks<a aria-hidden="true" class="hash-link" href="#react-hooks" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="useplugin"></a>usePlugin<a aria-hidden="true" class="hash-link" href="#useplugin" title="Direct link to heading">#</a></h3><p>Usage: <code>const instance = usePlugin(plugin)</code></p><p>Can be used by any component in the plugin, and gives the current <code>instance</code> that corresponds with the currently loaded plugin.
The <code>plugin</code> parameter isn&#x27;t actually used, but used to verify that a component is used correctly inside a mounted component, and helps with type inference.
The returned <code>instance</code> method corresponds to the object that is returned from the <code>plugin</code> / <code>devicePlugin</code> definition.
See the <a href="/docs/tutorial/js-custom#building-an-user-interface-for-the-plugin">tutorial</a> for how this hook is used in practice.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="usevalue"></a>useValue<a aria-hidden="true" class="hash-link" href="#usevalue" title="Direct link to heading">#</a></h3><p>Usage: <code>const currentValue = useValue(stateAtom)</code></p><p>Returns the current value of a state atom, and also subscribes the current component to future changes of the atom (in contrast to using <code>stateAtom.get()</code> directly).
See the <a href="/docs/tutorial/js-custom#building-an-user-interface-for-the-plugin">tutorial</a> for how this hook is used in practice.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="uselogger"></a>useLogger<a aria-hidden="true" class="hash-link" href="#uselogger" title="Direct link to heading">#</a></h3><p>Usage: <code>const logger = useLogger()</code></p><p>Provides the default logger that can be used for console logging, error reporting and performance measurements.
In internal Facebook builds this is wired up to the internal statistic reporting.
Prefer using <code>logger</code> over using <code>console</code> directly.</p><p>The logger API is defined as:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Logger</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">track</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token maybe-class-name">TrackType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">trackTimeSince</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    mark</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    eventName</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">null</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> undefined</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">warn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> category</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="usetrackedcallback"></a>useTrackedCallback<a aria-hidden="true" class="hash-link" href="#usetrackedcallback" title="Direct link to heading">#</a></h3><p>Usage: <code>const eventHandler = useTrackedCallback(&quot;Interaction description&quot;, handlerFunction, deps)</code></p><p>Utility that wraps React&#x27;s <code>useCallback</code> with tracking capabilities.
The API is similar, except that the first argument describes the interaction handled by the given event handler.
See <a href="#tracked">Tracked</a> for more info. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ui-components"></a>UI components<a aria-hidden="true" class="hash-link" href="#ui-components" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="layout"></a>Layout.*<a aria-hidden="true" class="hash-link" href="#layout" title="Direct link to heading">#</a></h3><p>Layout elements can be used to organize the screen layout.
See <code>View &gt; Flipper Style Guide</code> inside the Flipper application for more details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="nux"></a>NUX<a aria-hidden="true" class="hash-link" href="#nux" title="Direct link to heading">#</a></h3><p>An element that can be used to provide a New User eXperience: Hints that give a one time introduction to new features to the current user.
See <code>View &gt; Flipper Style Guide</code> inside the Flipper application for more details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="theme-object"></a>theme object<a aria-hidden="true" class="hash-link" href="#theme-object" title="Direct link to heading">#</a></h3><p>Provides a standard set of colors and spacings, used by the Flipper style guide.
The colors exposed here support dark mode.
See <code>View &gt; Flipper Style Guide</code> inside the Flipper application for more details.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="utilities"></a>Utilities<a aria-hidden="true" class="hash-link" href="#utilities" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="batch"></a>batch<a aria-hidden="true" class="hash-link" href="#batch" title="Direct link to heading">#</a></h3><p>Usage: <code>batch(() =&gt; { /* state updates */ })</code></p><p>Low-level utility to batch state updates to reduce the amount of potential re-renders by React.
Wraps React&#x27;s <code>unstable_batchedUpdates</code>.
Event handlers provided by React or <code>flipper-plugin</code> already apply <code>batch</code> automatically, so using this utility is only recommended when updating plugin state in an asynchronous process. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="produce"></a>produce<a aria-hidden="true" class="hash-link" href="#produce" title="Direct link to heading">#</a></h3><p>A convenience re-export of <code>produce</code> from <a href="https://immerjs.github.io/immer/docs/produce" target="_blank" rel="noopener noreferrer">Immer</a>.
The <code>update</code> method of the state atoms returned by <code>createState</code> automatically applies <code>produce</code> to its updater function. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="renderreactroot"></a>renderReactRoot<a aria-hidden="true" class="hash-link" href="#renderreactroot" title="Direct link to heading">#</a></h3><p>Usage: <code>renderReactRoot(handler: (unmount: () =&gt; void) =&gt; React.ReactElement)</code></p><p>Renders an element outside the current DOM tree.
This is a low-level utility that can be used to render for example Modal dialogs.
The provided <code>handler</code> function should return the root element to be rendered.
Once the element can be removed from the DOM, the <code>unmount</code> callback should be called.
Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-typescript codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">renderReactRoot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">unmount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">RequiredParametersDialog</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onHide</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">unmount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uri</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">filteredQuery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    requiredParameters</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    onSubmit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">navigateTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="sleep"></a>sleep<a aria-hidden="true" class="hash-link" href="#sleep" title="Direct link to heading">#</a></h2><p>Usage: <code>await sleep(1000)</code></p><p>Creates a promise that automatically resolves after the specified amount of milliseconds.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="styled"></a>styled<a aria-hidden="true" class="hash-link" href="#styled" title="Direct link to heading">#</a></h2><p>A convenience re-export of <code>styled</code> from <a href="https://emotion.sh/docs/styled" target="_blank" rel="noopener noreferrer">emotion</a>.  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="testutils"></a>TestUtils<a aria-hidden="true" class="hash-link" href="#testutils" title="Direct link to heading">#</a></h2><p>The object <code>TestUtils</code> as exposed from <code>flipper-plugin</code> exposes utilities to write unit tests for Sandy plugins.
Different utilities are exposed depending on whether you want to test a client or device plugin, and whether or not the component should be rendered or only the logic itself is going to be tested.
It is recommended to follow the <a href="/docs/tutorial/js-custom">tutorial</a> first, as it explains how unit tests should be setup.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="starting-a-plugin"></a>Starting a plugin<a aria-hidden="true" class="hash-link" href="#starting-a-plugin" title="Direct link to heading">#</a></h3><p>Usage:</p><ul><li><code>const runner = TestUtils.startPlugin(pluginModule, options?)</code></li><li><code>const runner = TestUtils.renderPlugin(pluginModule, options?)</code></li><li><code>const runner = TestUtils.startDevicePlugin(devicePluginModule, options?)</code></li><li><code>const runner = TestUtils.renderDevicePlugin(devicePluginModule, options?)</code></li></ul><p>Starts a client plugin in a fully mocked environment, but without rendering support.
The pluginModule is an object that has a <code>plugin</code> (or <code>devicePlugin</code> and <code>supportsDevice</code>) and <code>Component</code> property.
Typically, it is invoked with <code>startPlugin(PluginUnderTest)</code>, where <code>PluginUnderTest</code> is loaded like <code>import * as PluginUnderTest from &quot;../index.tsx&quot;</code> (the path to the actual definition).
However, it doesn&#x27;t have to be loaded with an entire module, and a local object with the same signature can be constructed as well.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="startplugin-options"></a>startPlugin options<a aria-hidden="true" class="hash-link" href="#startplugin-options" title="Direct link to heading">#</a></h4><p>The <code>options</code> argument is optional, but can specify the following fields:</p><ul><li><code>initialState</code>: Can be used to start the plugin in a certain state, rather than in the default state. <code>initialState</code> should be an object that specifies for all the state atoms that have the <code>persist</code> option set, their initial value. For example: <code>{ initialState: { rows: [&quot;hello&quot;, &quot;world&quot;]}}</code>, where <code>rows</code> matches the <code>persist</code> key of an atom.</li><li><code>isArchived: boolean</code>: Setting this flag, will set the <code>isArchived</code> on the mocked device as well. Set it if you want to test the behavior of your plugin for imported devices (see also <a href="#isarchived"><code>Device.isArchived</code></a>). Defaults to <code>false</code>.</li><li><code>isBackgroundPlugin</code>: This makes sure the test runner emits life-cycle events in a way that is typical for background plugins. Defaults to <code>false</code>. The notable difference in behavior is that calling <code>.active()</code> on the test runner won&#x27;t trigger the <code>connect</code> event to be fired, nor the <code>.deactivate()</code> the <code>disconnect</code> event.</li><li><code>startUnactivated</code>: This does not activate the plugin; <code>connect</code> needs to be explicitly called. This can be used in case setting mock implementation for <code>onSend</code> is required to make sure Client plugin works as expected. Defaults to <code>false</code>.</li><li><code>GKs</code>: A string array of gatekeeper names for which <code>client.GK</code> will <code>true</code> inside the test. By default GKs are assumed to be disabled inside unit tests.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-test-runner-object"></a>The test runner object<a aria-hidden="true" class="hash-link" href="#the-test-runner-object" title="Direct link to heading">#</a></h4><p><code>startPlugin</code> returns an object that can be used to inspect and interact with your plugin instance.
Again, see the tutorial how to interact with this object in general.
The test runner is a bag full of utilities, but typically it is fine to just destructure the utilities relevant for the test.
Exposed members:</p><ul><li><code>instance</code>: The object (public API) returned from your plugin definition. You will typically use this in most tests, either to trigger updates or to inspect the current state of the plugin.</li><li><code>exportState()</code>: Grabs the current state of all <code>persist</code> enabled state atoms. The object format returned here is the same as in the <code>initialState</code> option.</li><li><code>activate()</code>: Emulate the <code>onActivate</code> event. By default, <code>startPlugin</code> already starts the plugin in activated state, and calling <code>activate</code> to test the <code>onActivate</code> event should be preceded by a <code>deactivate()</code> call first.</li><li><code>deactivate()</code>: Emulates a user navigating away from the plugin.</li><li><code>destroy()</code>: Emulates the plugin being cleaned up, for example because the plugin is disabled by the user, or because the device / client has disconnected. After calling <code>destroy</code> the current <code>runner</code> is unusable.</li><li><code>triggerDeepLink(payload)</code>: Emulates a deepLink being triggered, and fires the <code>onDeepLink</code> event.</li><li><code>triggerMenuEntry(label)</code>: Emulates the user clicking a menu entry in the Flipper main menu.</li><li><code>flipperLib</code>: An object that exposed <code>jest.fn()</code> mocks for all built-in Flipper APIs that can be called by your plugin. So assertions can be made that the plugin did actually invoke those methods. For example: <code>expect(runner.flipperLib.createPaste).toBeCalledWith(&quot;test message&quot;)</code>. Currently supported mocks: <code>createPaste</code>, <code>enableMenuEntries</code>.</li></ul><p>The following members are available when using the <code>render...</code> variant rather than the <code>start...</code> variant:</p><ul><li><code>renderer</code>: This object can be used to query the DOM and further interact with it. It is provided by react-testing-library, and further documented <a href="https://testing-library.com/docs/react-testing-library/api#render-result" target="_blank" rel="noopener noreferrer">here</a>.</li><li><code>act</code>: Use this function to wrap interactions with the plugin under test into a transaction, after which the DOM updates will be flushed by React. See also the <a href="https://reactjs.org/docs/test-utils.html#act" target="_blank" rel="noopener noreferrer"><code>act</code></a> documentation.</li></ul><p>The following members are only available for Client plugins:</p><ul><li><code>sendEvent(event, params)</code>: Emulates an event being sent by the client plugin. Will trigger the corresponding <code>onMessage</code> handler in the plugin.</li><li><code>sendEvents({ method: string, params: object}[])</code>: Like <code>sendEvent</code>, but sends multiple events at once.</li><li><code>onSend</code>: A <code>jest.fn()</code> that can be used to assert that <code>client.send()</code> was called by the plugin under test. For example <code>expect(runner.onSend).toBeCalledWith(&#x27;currentLogs</code>, { since: 0})`.</li><li><code>connect()</code>: Triggers the <code>onConnect()</code> event. (For non-background plugins <code>activate()</code> could as well be used for this).</li><li><code>disconnect()</code>: Triggers the <code>onDisconnect()</code> event. (For non-background plugins <code>deactivate()</code> could as well be used for this).</li></ul><p>The following members are only available for Device plugins:</p><ul><li><code>sendLogEntry(logEntry)</code>: Emulates a log message arriving from the device. Triggers the <code>client.device.onLogEntry</code> listener.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/flipper/blob/master/website/../docs/extending/flipper-plugin.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/extending/plugin-distribution"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Plugin Distribution</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/extending/styling-components"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Styling Components Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pluginclient" class="table-of-contents__link">PluginClient</a><ul><li><a href="#properties" class="table-of-contents__link">Properties</a></li><li><a href="#events-listeners" class="table-of-contents__link">Events listeners</a></li><li><a href="#methods" class="table-of-contents__link">Methods</a></li></ul></li><li><a href="#devicepluginclient" class="table-of-contents__link">DevicePluginClient</a><ul><li><a href="#properties-1" class="table-of-contents__link">Properties</a></li><li><a href="#events" class="table-of-contents__link">Events</a></li><li><a href="#methods-1" class="table-of-contents__link">Methods</a></li><li><a href="#ispluginavailable-1" class="table-of-contents__link"><code>isPluginAvailable</code></a></li><li><a href="#selectplugin-1" class="table-of-contents__link"><code>selectPlugin</code></a></li></ul></li><li><a href="#device-2" class="table-of-contents__link">Device</a><ul><li><a href="#properties-2" class="table-of-contents__link">Properties</a></li><li><a href="#events-1" class="table-of-contents__link">Events</a></li></ul></li><li><a href="#state-management" class="table-of-contents__link">State Management</a><ul><li><a href="#createstate" class="table-of-contents__link">createState</a></li></ul></li><li><a href="#react-hooks" class="table-of-contents__link">React Hooks</a><ul><li><a href="#useplugin" class="table-of-contents__link">usePlugin</a></li><li><a href="#usevalue" class="table-of-contents__link">useValue</a></li><li><a href="#uselogger" class="table-of-contents__link">useLogger</a></li><li><a href="#usetrackedcallback" class="table-of-contents__link">useTrackedCallback</a></li></ul></li><li><a href="#ui-components" class="table-of-contents__link">UI components</a><ul><li><a href="#layout" class="table-of-contents__link">Layout.*</a></li><li><a href="#nux" class="table-of-contents__link">NUX</a></li><li><a href="#tracked" class="table-of-contents__link">Tracked</a></li><li><a href="#trackingscope" class="table-of-contents__link">TrackingScope</a></li><li><a href="#withtrackingscope" class="table-of-contents__link">withTrackingScope</a></li><li><a href="#theme-object" class="table-of-contents__link">theme object</a></li></ul></li><li><a href="#utilities" class="table-of-contents__link">Utilities</a><ul><li><a href="#batch" class="table-of-contents__link">batch</a></li><li><a href="#produce" class="table-of-contents__link">produce</a></li><li><a href="#renderreactroot" class="table-of-contents__link">renderReactRoot</a></li></ul></li><li><a href="#sleep" class="table-of-contents__link">sleep</a></li><li><a href="#styled" class="table-of-contents__link">styled</a></li><li><a href="#testutils" class="table-of-contents__link">TestUtils</a><ul><li><a href="#starting-a-plugin" class="table-of-contents__link">Starting a plugin</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/index">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorial/intro">Plugin Creation Tutorial</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Plugins</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/features/index">Core Plugins</a></li><li class="footer__item"><a href="https://www.npmjs.com/search?q=keywords:flipper-plugin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Plugins</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/flipper_fb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://github.com/facebook/flipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Flipper Mascot" src="/img/mascot.png"></div><div>Copyright Â© 2021 Facebook</div></div></div></footer></div>
<script src="/styles.0cfb5519.js"></script>
<script src="/runtime~main.07d19881.js"></script>
<script src="/main.cfff2d1e.js"></script>
<script src="/1.f499c85c.js"></script>
<script src="/70.13b53424.js"></script>
<script src="/73.def975d9.js"></script>
<script src="/935f2afb.a1e65e9e.js"></script>
<script src="/69.7041db55.js"></script>
<script src="/1dfa6ca3.3aab30cb.js"></script>
</body>
</html>